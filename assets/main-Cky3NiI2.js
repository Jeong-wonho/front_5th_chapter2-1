import"./modulepreload-polyfill-B5Qt9EMX.js";let c,r,s,p,u,f,T,m=0,h=0;const y=Object.freeze({SALE_PROBABILITY:.3,BASIC_RATE:.2,ADDITIONAL_RATE:.05,TUESDAY_RATE:.1,BULK_RATE:.25}),A=Object.freeze({LOW_STOCK_THRESHOLD:5}),b=Object.freeze({p1:.1,p2:.15,p3:.2,p4:.05,p5:.25});function v(){c=[{id:"p1",name:"상품1",price:1e4,quantity:50},{id:"p2",name:"상품2",price:2e4,quantity:30},{id:"p3",name:"상품3",price:3e4,quantity:20},{id:"p4",name:"상품4",price:15e3,quantity:0},{id:"p5",name:"상품5",price:25e3,quantity:10}];let e=document.getElementById("app"),t=document.createElement("div"),n=document.createElement("div"),a=document.createElement("h1");p=document.createElement("div"),u=document.createElement("div"),r=document.createElement("select"),s=document.createElement("button"),f=document.createElement("div"),t.className="bg-gray-100 p-8",n.className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8",a.className="text-2xl font-bold mb-4",p.id="cart-items",u.id="cart-total",r.id="product-select",s.id="add-to-cart",f.id="stock-status",u.className="text-xl font-bold my-4",r.className="border rounded p-2 mr-2",s.className="bg-blue-500 text-white px-4 py-2 rounded",f.className="text-sm text-gray-500 mt-2",a.textContent="장바구니",s.textContent="추가",n.appendChild(a),n.appendChild(p),n.appendChild(u),n.appendChild(r),n.appendChild(s),n.appendChild(f),t.appendChild(n),e.appendChild(t),C(),E(),setTimeout(function(){setInterval(function(){let i=c[Math.floor(Math.random()*c.length)];R(i)&&(i.price=Math.round(i.price*(1-DISCOUNT_RATE)),alert("번개세일! "+i.name+"이(가) 20% 할인 중입니다!"),C())},3e4)},Math.random()*1e4),setTimeout(function(){setInterval(function(){if(!T)return;let i=S();i&&(alert(i.name+"은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!"),i.price=Math.round(suggest.price*(1-ADDITIONAL_DISCOUNT_RATE)),C())},6e4)},Math.random()*2e4)}function S(){return c.find(e=>e.id!==T&&e.quantity>0)}function C(){r.innerHTML="",c.forEach(function(e){let t=L(e);r.appendChild(t)})}function L(e){const t=document.createElement("option");return t.value=e.id,t.textContent=e.name+" - "+e.price+"원",e.quantity===0&&(t.disabled=!0),t}function O(e){var l;const t=e.id,n=c.find(q=>q.id===t);if(!n)return{quantity:0,itemTotal:0,discountedTotal:0};const a=(l=e.querySelector("span"))==null?void 0:l.textContent,i=a?parseInt(a.split("x ")[1]):0,d=n.price*i,o=i>=10?b[t]??0:0,x=d*(1-o);return{quantity:i,itemTotal:d,discountedTotal:x}}function D(e,t,n){if(n>=30){const a=t*y.BULK_RATE,i=e-t;if(a>i)return y.BULK_RATE}return(e-t)/e||0}function E(){m=0,h=0;let e=p.children,t=0;Array.from(e).forEach(a=>{const{quantity:i,itemTotal:d,discountedTotal:o}=O(a);h+=i,t+=d,m+=o});let n=D(t,m,h);if(new Date().getDay()===2&&(m*=1-y.TUESDAY_RATE,n=Math.max(n,y.TUESDAY_RATE)),u.textContent="총액: "+Math.round(m)+"원",n>0){let a=document.createElement("span");a.className="text-green-500 ml-2",a.textContent="("+(n*100).toFixed(1)+"% 할인 적용)",u.appendChild(a)}B(),_()}function R(e){return Math.random()<y.SALE_PROBABILITY&&e.quantity>0}function _(){const e=Math.floor(m/1e3);let t=document.getElementById("loyalty-points");t||(t=document.createElement("span"),t.id="loyalty-points",t.className="text-blue-500 ml-2",u.appendChild(t)),t.textContent="(포인트: "+e+")"}function B(){let e="";c.forEach(function(t){t.quantity<A.LOW_STOCK_THRESHOLD&&(e+=t.name+": "+(t.quantity>0?"재고 부족 ("+t.quantity+"개 남음)":"품절")+`
`)}),f.textContent=e}v();function N(){const e=r.value,t=c.find(function(a){return a.id===e});if(!t||t.quantity<=0)return;const n=document.getElementById(t.id);if(n)w(n,t);else{const a=M(t);p.appendChild(a),t.quantity--}E(),T=e}function w(e,t){const n=e.querySelector("span"),a=parseInt(n.textContent.split("x ")[1],10);if(t.quantity>0){const i=a+1;n.textContent=`${t.name} - ${t.price}원 x ${i}`,t.quantity--}else alert("재고가 부족합니다.")}function M(e){const t=`
  <div id="${e.id}" class="flex justify-between items-center mb-2">
      <span>${e.name} - ${e.price}원 x 1</span>
      <div>
        <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${e.id}" data-change="-1">-</button>
        <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${e.id}" data-change="1">+</button>
        <button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${e.id}">삭제</button>
      </div>
    </div>
  `,n=document.createElement("template");return n.innerHTML=t.trim(),n.content.firstChild}function P(e){return e.classList.contains("quantity-change")||e.classList.contains("remove-item")}function U(e){return c.find(t=>t.id===e)}function k(e,t,n){return n<=0?!1:n<=e.quantity+t}function I(e,t){return e.classList.contains(t)}function g(e){return parseInt(e.split("x ")[1])}s.addEventListener("click",N);p.addEventListener("click",function(e){let t=e.target;if(P(t)){let n=t.dataset.productId,a=document.getElementById(n),i=U(n),d=a.querySelector("span").textContent;if(I(t,"quantity-change")){let o=parseInt(t.dataset.change),x=g(d),l=x+o;k(i,x,l)?(a.querySelector("span").textContent=d.split("x ")[0]+"x "+l,i.quantity-=o):l<=0?(a.remove(),i.quantity-=o):alert("재고가 부족합니다.")}else if(I(t,"remove-item")){let o=g(d);i.quantity+=o,a.remove()}E()}});
